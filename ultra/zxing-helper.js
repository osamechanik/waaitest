(function(){async function ensure(){if(!window.__ZXING__){const m=await import('https://esm.sh/@zxing/browser@0.1.4');window.__ZXING__=m;}return window.__ZXING__;}
window.zxingStart=async function(video,onResult,onError){try{const m=await ensure();const r=new m.BrowserMultiFormatReader();const devices=await m.BrowserCodeReader.listVideoInputDevices();const id=(devices&&devices[0]&&devices[0].deviceId)||undefined;await r.decodeFromVideoDevice(id,video,(res,err)=>{if(res)onResult&&onResult(res.getText());if(err&&!(err&&err.name==='NotFoundException')){onError&&onError(err);}});return()=>r.reset();}catch(e){onError&&onError(e);return()=>{};}}})();